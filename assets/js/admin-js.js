jQuery(function($){var mediaUploader;$('.upload-button').each(function(e){$(this).on('click',function(){$hiddenImage=$(this).next().attr('id');if(mediaUploader){mediaUploader.open();return}
mediaUploader=wp.media.frames.file_frame=wp.media({title:'Choose Image',button:{text:'Choose Picture'},multiple:!1});mediaUploader.on('select',function(){attachment=mediaUploader.state().get('selection').first().toJSON();$id='#'+$hiddenImage;$class='.'+$hiddenImage;$($id).val(attachment.url);$.ajax({url:admin_ajax.ajax,success:function(data){$($class).attr('src',attachment.url)}})});mediaUploader.open()})})})